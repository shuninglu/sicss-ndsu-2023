{
  "hash": "a3ec4aaff0f0dc4b77c01edda2950c16",
  "result": {
    "markdown": "# Text analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(quanteda)\noptions(width = 110)\nrequire(readtext)\nlibrary(tidyverse)\nrequire(quanteda.textstats)\nrequire(quanteda.textplots)\nfdata_sub <- read_csv(\"data/12k/fdata_sub.csv\")\nlibrary(knitr)\n```\n:::\n\n\n## Ngram analysis in Quanteda\n\n\n### Creating the corpus object\n\nSample of corpus\n\n::: {.cell}\n\n```{.r .cell-code}\ncorp <- corpus(fdata_sub, text_field = \"abstract\")\n\nglimpse(docvars(corp))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 12,229\nColumns: 9\n$ article_title        <chr> \"Critical Approaches to the Climate Crisis\", \"Addressing the Climate Crisis: An…\n$ source_title         <chr> \"SOCIAL MEDIA + SOCIETY\", \"AMERICAN PSYCHOLOGIST\", \"INNOVATION-THE EUROPEAN JOU…\n$ journal_abbreviation <chr> \"SOC MEDIA SOC\", \"AM PSYCHOL\", \"INNOVATION-ABINGDON\", \"WIRES CLIM CHANGE\", \"ENV…\n$ publication_date     <chr> \"JUN\", \"OCT\", \"JUL 3\", \"MAR\", \"JAN 2\", NA, \"NOV\", \"MAY\", NA, NA, NA, \"MAR\", NA,…\n$ publication_year     <dbl> 2023, 2022, 2022, 2022, 2020, 2011, 2021, 2022, 2009, 2009, 2020, 2015, 2022, 2…\n$ doi                  <chr> \"10.1177/20563051231177941\", \"10.1037/amp0001041\", \"10.1080/13511610.2022.21080…\n$ wo_s_categories      <chr> \"Communication\", \"Psychology, Multidisciplinary\", \"Sociology\", \"Environmental S…\n$ ids_number           <chr> \"I8MI2\", \"5O9KQ\", \"4N9QD\", \"ZP6QN\", \"KA4VQ\", \"BA0OR\", \"WX8NB\", \"1V6OA\", \"V17AH\"…\n$ ut_unique_wos_id     <chr> \"WOS:001005267200001\", \"WOS:000844824500001\", \"WOS:000843135900001\", \"WOS:00074…\n```\n:::\n:::\n\n\n\n\n### Creating the tokens object\n\nHead (first bigrams)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntoks <- tokens(corp, remove_punct = TRUE)\n\ntoks_nostop <- tokens_select(toks, pattern = stopwords(\"en\"), selection = \"remove\")\n\ntoks_ngram <- tokens_ngrams(toks_nostop, n = 2)\n\nhead(toks_ngram[[1]], 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"essay_turns\"        \"turns_theories\"     \"theories_developed\" \"developed_critical\" \"critical_rhetoric\" \n```\n:::\n:::\n\n\n\n### Creating the document feature matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndfm <- dfm(toks_ngram)\ntopfeatures(dfm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   climate_change    global_warming         degrees_c    global_climate               n_=   rights_reserved \n            17098              1969               951               712               678               634 \n     results_show    greenhouse_gas change_adaptation   impacts_climate \n              610               577               526               521 \n```\n:::\n:::\n\n\n\n\nIn abstracts, raw counts by year:\n\n* \"climate_change\"\n* \"global_warming\"\n* \"climate_crisis\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get frequency grouped by year\nfreq_grouped <- textstat_frequency(dfm(toks_ngram), \n                                   groups = publication_year)\n\n\n\n# Filter the term \"climate\"\nfreq_climate_change <- subset(freq_grouped, freq_grouped$feature %in% \"climate_change\")  \n\nfreq_global_warming <- subset(freq_grouped, freq_grouped$feature %in% \"global_warming\")\n\nfreq_climate_crisis <- subset(freq_grouped, freq_grouped$feature %in% \"climate_crisis\")\n\n\nbound_frames <- rbind(\n      freq_global_warming,\n      freq_climate_change,\n      freq_climate_crisis)\n\nfig01 <- ggplot(bound_frames %>% filter(group != \"2023\"), aes(x = as.numeric(group), y = frequency, color = feature)) +\n    geom_point() + \n    geom_line() +\n    scale_y_continuous() +\n    xlab(NULL) + \n    ylab(\"Frequency\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n   theme_minimal() +\n  labs(title = \"Phraseology, emerging\")\n\nfig01\n```\n\n::: {.cell-output-display}\n![](text_analysis_files/figure-html/unnamed-chunk-5-1.png){width=864}\n:::\n:::\n\n\n## Climate Frames\n\nProportion of phrase: counts divided by sum of target phrases in year\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get frequency grouped by year\nfreq_grouped <- textstat_frequency(dfm(toks_ngram), \n                                   groups = publication_year)\n\n\n\n# Filter the term \"climate\"\nfreq_climate_change <- subset(freq_grouped, freq_grouped$feature %in% \"climate_change\")  \n\nfreq_global_warming <- subset(freq_grouped, freq_grouped$feature %in% \"global_warming\")\n\nfreq_climate_crisis <- subset(freq_grouped, freq_grouped$feature %in% \"climate_crisis\")\n\n\nbound_frames <- rbind(\n      freq_global_warming,\n      freq_climate_change,\n      freq_climate_crisis) %>%\n  group_by(group) %>%\n  mutate(prop = frequency/sum(frequency)) %>%\n  ungroup()\n\nfig02 <- ggplot(bound_frames %>% filter(group != \"2023\") , aes(x = as.numeric(group), y = prop, color = feature)) +\n    geom_point() + \n    geom_line() +\n    scale_y_continuous() +\n    xlab(NULL) + \n    ylab(\"Frequency\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n   theme_minimal()\n\nfig02\n```\n\n::: {.cell-output-display}\n![](text_analysis_files/figure-html/unnamed-chunk-6-1.png){width=864}\n:::\n:::\n\n\n## Phrases of interest\n\nKey phrases, grouped loosely:\n\nEquity and justice\n\n* climate justice\n* environmental justice\n* environmental equity\n* climate equity\n* environmental equity\n* climate equity\n\nConsensus and denial\n\n* scientific consensus\n* climate denial\n* climate skepticism\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfreq_climate_action <- subset(freq_grouped, freq_grouped$feature %in% \"climate_action\")\n\n# equity and justice frame\n\nfreq_climate_justice <- subset(freq_grouped, freq_grouped$feature %in% \"climate_justice\")\n\nfreq_enviro_justice <- subset(freq_grouped, freq_grouped$feature %in% \"environmental_justice\")\n\nfreq_env_equity <- subset(freq_grouped, freq_grouped$feature %in% \"environmental_equity\")\n\nfreq_clim_equity <- subset(freq_grouped, freq_grouped$feature %in% \"climate_equity\")\n\nfreq_climate_adaptation <- subset(freq_grouped, freq_grouped$feature %in% \"climate_adaptation\")\n\n# consensus, denial\n\nfreq_sci_consensus <- subset(freq_grouped, freq_grouped$feature %in% \"scientific_consensus\")\n\nfreq_climate_denial <- subset(freq_grouped, freq_grouped$feature %in% \"climate_denial\")\n\nfreq_climate_skepticism <- subset(freq_grouped, freq_grouped$feature %in% \"climate_skepticism\")\n\n\n# bind above\n\nbound_something <- rbind(\n      freq_climate_denial,\n      freq_climate_skepticism,\n      freq_climate_action,\n      freq_climate_justice,\n      freq_enviro_justice,\n      freq_climate_adaptation,\n      freq_sci_consensus,\n      freq_env_equity,\n      freq_clim_equity\n      )\n\nfig03 <- ggplot(bound_something %>% filter(group != \"2023\"), aes(x = as.numeric(group), y = frequency, color = feature)) +\n    geom_point() + \n    geom_line() +\n    scale_y_continuous() +\n    xlab(NULL) + \n    ylab(\"Frequency\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  theme_minimal() +\n  labs(title = \"Bigrams of interest, over time\")\n\nfig03\n```\n\n::: {.cell-output-display}\n![](text_analysis_files/figure-html/unnamed-chunk-7-1.png){width=864}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfig04 <- ggplot(bound_something %>% filter(group != \"2023\"), aes(x = as.numeric(group), y = frequency, color = feature)) +\n    geom_smooth(se=F) +\n    scale_y_continuous() +\n    xlab(NULL) + \n    ylab(\"Frequency\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  theme_minimal() +\n  labs(title = \"bigrams of interest, over time (smoothed)\")\n\nfig04\n```\n\n::: {.cell-output-display}\n![](text_analysis_files/figure-html/unnamed-chunk-8-1.png){width=864}\n:::\n:::\n\n\n\nAs a proportion...\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbound_st_prop <- bound_something %>%\n  group_by(feature) %>%\n  mutate(prop2 = frequency/sum(frequency)) %>%\n  ungroup()\n\nfig05 <- ggplot(bound_st_prop %>% filter(group != \"2023\"), aes(x = as.numeric(group), y = prop2, color = feature)) +\n    geom_point() + \n    geom_line() +\n    scale_y_continuous() +\n    xlab(NULL) + \n    ylab(\"proportion of bigrams of interest\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  theme_minimal() +\n  labs(title = \"bigrams of interest, as a proportion of total\")\n\nfig05\n```\n\n::: {.cell-output-display}\n![](text_analysis_files/figure-html/unnamed-chunk-9-1.png){width=864}\n:::\n:::\n\nGrouped\n\n* Belief = climate skepticism, climate denial, scientific consensus\n* Equity = climate justice, environmental justice, climate equity, environmental equity\n* Response = climate action, climate adaptation\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngroup_frame <- bound_something %>%\n  mutate(feature_2 = ifelse(feature %in% c(\"climate_action\", \"climate_adaptation\"), \"climate_response\", \n                            ifelse(feature %in% c(\"climate_skeptism\", \"climate_denial\", \"scientific_consensus\"), \"climate_belief\", \n                                   \"climate_equity\")))\n\nfig06 <- ggplot(group_frame %>% filter(group != \"2023\"), aes(x = as.numeric(group), y = frequency, color = feature_2)) +\n    geom_smooth(se=F) +\n    scale_y_continuous() +\n    xlab(NULL) + \n    ylab(\"Group frequency\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  theme_minimal() +\n  labs(title = \"Shifting foci: \\nIs it real? Who will it affect? What do we do? \",\n       subtitle = \"grouped bigrams as frames\")\n\nfig06\n```\n\n::: {.cell-output-display}\n![](text_analysis_files/figure-html/unnamed-chunk-10-1.png){width=864}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngroup_frame_prop <- bound_st_prop %>%\n  mutate(feature_2 = ifelse(feature %in% c(\"climate_action\", \"climate_adaptation\"), \"climate_response\", \n                            ifelse(feature %in% c(\"climate_skeptism\", \"climate_denial\", \"scientific_consensus\"), \"climate_belief\", \n                                   \"climate_equity\")))%>%\n  group_by(feature_2) %>%\n  mutate(prop2 = frequency/sum(frequency)) %>%\n  ungroup()\n\nfig07 <- ggplot(group_frame_prop %>% filter(group != \"2023\"), aes(x = as.numeric(group), y = prop2, color = feature_2)) +\n    geom_smooth(se=F) +\n    scale_y_continuous() +\n    xlab(NULL) + \n    ylab(\"Proportion of Sum\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  ggtitle(\"Shifting foci: \\nIs it real? Who will it affect? What do we do? \") +\n  theme_minimal()\n\nfig07\n```\n\n::: {.cell-output-display}\n![](text_analysis_files/figure-html/unnamed-chunk-11-1.png){width=864}\n:::\n:::\n\n\n## Outputs\n\n\n\n",
    "supporting": [
      "text_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}